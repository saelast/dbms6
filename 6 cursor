> create table o_rollcall(roll_no int,namevarchar(20),address
varchar(20));
Query OK, 0 rows affected (0.28 sec)
> create table n_rollcall(roll_no int,namevarchar(20),address
varchar(20));
Query OK, 0 rows affected (0.27 sec)
> insert into o_rollcall values('1','Hitesh','Nandura');Query OK, 1
row affected (0.05 sec)
> insert into o_rollcall values('2','Piyush','MP');Query OK, 1
row affected (0.06 sec)
> insert into o_rollcall values('3','Ashley','Nsk');Query OK, 1
row affected (0.05 sec)
> insert into o_rollcall values('4','Kalpesh','Dhule');Query OK, 1
row affected (0.05 sec)
> insert into o_rollcall values('5','Abhi','Satara');Query OK, 1
row affected (0.04 sec)
> delimiter //
> create procedure p3(in r1 int)
-> begin
-> declare r2 int;
-> declare exit_loop boolean;
-> declare c1 cursor for select roll_no from o_rollcallwhere
roll_no>r1;
-> declare continue handler for not found setexit_loop=true;
-> open c1;
-> e_loop:loop
-> fetch c1 into r2;
-> if not exists(select * from n_rollcall whereroll_no=r2)
-> then
-> insert into n_rollcall select * from o_rollcall where
roll_no=r2;
-> end if;
-> if exit_loop
-> then
-> close c1;
-> leave e_loop;
-> end if;
-> end loop e_loop;
-> end
-> //
Query OK, 0 rows affected (0.00 sec)
> call p3(3);
-> //
Query OK, 0 rows affected (0.10 sec)
> select * from n_rollcall;
-> //
+---------+---------+---------+
| roll_no | name | address |
+---------+---------+---------+
| 4 | Kalpesh | Dhule |
| 5 | Abhi | Satara |
+---------+---------+---------+
2 rows in set (0.00 sec)
> call p3(0);
-> //
Query OK, 0 rows affected (0.22 sec)
> select * from n_rollcall;
-> //
+---------+---------+---------+
| roll_no | name | address |
+---------+---------+---------+
| 4 | Kalpesh | Dhule |
| 5 | Abhi | Satara |
| 1 | Hitesh | Nandura |
| 2 | Piyush | MP |
| 3 | Ashley | Nsk |
+---------+---------+---------+
5 rows in set (0.00 sec)
> insert into o_rollcall values('6','Patil','Kolhapur');
-> //
Query OK, 1 row affected (0.04 sec)
> call p3(4);
-> //
Query OK, 0 rows affected (0.05 sec)
> select * from n_rollcall;
-> //
+---------+---------+----------+
| roll_no | name | address |
+---------+---------+----------+
| 4 | Kalpesh | Dhule |
| 5 | Abhi | Satara |
| 1 | Hitesh | Nandura |
| 2 | Piyush | MP |
| 3 | Ashley | Nsk |
| 6 | Patil | Kolhapur |
+---------+---------+----------+
6 rows in set (0.00 sec)
